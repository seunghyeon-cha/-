(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1185],{8948:function(e,t,r){Promise.resolve().then(r.bind(r,9743))},9376:function(e,t,r){"use strict";var a=r(5475);r.o(a,"useParams")&&r.d(t,{useParams:function(){return a.useParams}}),r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}}),r.o(a,"useSearchParams")&&r.d(t,{useSearchParams:function(){return a.useSearchParams}})},9743:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return i}});var a=r(7437),s=r(2265),n=r(9376),o=r(5744);function i(){let e=(0,n.useRouter)(),[t,r]=(0,s.useState)([]),[i,c]=(0,s.useState)({total:0,page:1,limit:12,totalPages:0}),[l,d]=(0,s.useState)(!0),[u,m]=(0,s.useState)(""),[h,g]=(0,s.useState)("latest"),x=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2?arguments[2]:void 0;try{d(!0);let s=await (0,o.y)({sort:e||h,page:t,limit:12,search:a});r(s.data),c(s.meta)}catch(e){console.error("Failed to fetch itineraries:",e),r([]),c({total:0,page:1,limit:12,totalPages:0})}finally{d(!1)}},p=e=>{x(h,e,u),window.scrollTo({top:0,behavior:"smooth"})},f=()=>{e.push("/itinerary/new")},y=t=>{e.push("/itinerary/".concat(t))};(0,s.useEffect)(()=>{x()},[]);let v=(e,t)=>{let r=new Date(e),a=new Date(t),s=Math.abs(a.getTime()-r.getTime());return{formatted:"".concat(r.toLocaleDateString("ko-KR",{month:"short",day:"numeric"})," - ").concat(a.toLocaleDateString("ko-KR",{month:"short",day:"numeric"})),days:Math.ceil(s/864e5)+1}};return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("div",{className:"bg-white border-b border-gray-200",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-6 py-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"내 여행 일정"}),(0,a.jsx)("button",{onClick:f,className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:"+ 새 일정 만들기"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("form",{onSubmit:e=>{e.preventDefault(),x(h,1,u)},className:"flex-1 max-w-md",children:(0,a.jsx)("input",{type:"text",value:u,onChange:e=>m(e.target.value),placeholder:"일정 제목 또는 지역 검색...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500"})}),(0,a.jsxs)("select",{value:h,onChange:e=>{let t=e.target.value;g(t),x(t,1,u)},className:"px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-primary-500",children:[(0,a.jsx)("option",{value:"latest",children:"최신순"}),(0,a.jsx)("option",{value:"oldest",children:"오래된순"})]})]}),(0,a.jsxs)("div",{className:"mt-4 text-sm text-gray-600",children:["총 ",(0,a.jsx)("span",{className:"font-semibold text-gray-900",children:i.total}),"개의 일정"]})]})}),(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-6 py-8",children:l?(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.from({length:6}).map((e,t)=>(0,a.jsxs)("div",{className:"bg-white rounded-lg p-6 shadow-sm animate-pulse",children:[(0,a.jsx)("div",{className:"h-6 bg-gray-200 rounded w-3/4 mb-3"}),(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/2 mb-4"}),(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded w-full mb-2"}),(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded w-2/3"})]},t))}):t.length>0?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(e=>{let t=v(e.startDate,e.endDate);return(0,a.jsxs)("div",{onClick:()=>y(e.id),className:"bg-white rounded-lg p-6 shadow-sm hover:shadow-md transition-shadow cursor-pointer",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:e.title}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,a.jsx)("span",{className:"px-2 py-1 bg-primary-50 text-primary-600 text-xs font-semibold rounded",children:e.region}),e.isPublic&&(0,a.jsx)("span",{className:"px-2 py-1 bg-green-50 text-green-600 text-xs font-semibold rounded",children:"공개"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-2",children:[(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),(0,a.jsx)("span",{children:t.formatted})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,a.jsxs)("span",{children:[t.days,"일"]})]})]},e.id)})}),i.totalPages>1&&(0,a.jsx)("div",{className:"mt-8 flex justify-center gap-2",children:Array.from({length:i.totalPages},(e,t)=>t+1).map(e=>(0,a.jsx)("button",{onClick:()=>p(e),className:"px-4 py-2 rounded-lg ".concat(i.page===e?"bg-primary-600 text-white":"bg-white text-gray-700 hover:bg-gray-100"),children:e},e))})]}):(0,a.jsxs)("div",{className:"text-center py-16",children:[(0,a.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})}),(0,a.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"여행 일정이 없습니다"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"첫 번째 여행 일정을 만들어보세요!"}),(0,a.jsx)("button",{onClick:f,className:"mt-4 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:"+ 새 일정 만들기"})]})})]})}},6305:function(e,t,r){"use strict";r.d(t,{x:function(){return i}});var a=r(3464),s=r(9375),n=r(7802);let o="http://localhost:4000",i=a.Z.create({baseURL:o,headers:{"Content-Type":"application/json"}});i.interceptors.request.use(e=>{let{accessToken:t}=s.t.getState();return t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e)),i.interceptors.response.use(e=>e,async e=>{var t,r;let c=e.config;if(!e.response)return n.A.error("인터넷 연결을 확인해주세요"),Promise.reject(e);if((null===(t=e.response)||void 0===t?void 0:t.status)===401&&!c._retry){c._retry=!0;try{let{refreshToken:e}=s.t.getState();if(!e)throw Error("No refresh token");let{accessToken:t,refreshToken:r}=(await a.Z.post("".concat(o,"/api/auth/refresh"),{refreshToken:e})).data,{user:n}=s.t.getState();return n&&s.t.getState().setAuth(n,t,r),c.headers.Authorization="Bearer ".concat(t),i(c)}catch(e){return s.t.getState().clearAuth(),n.A.error("세션이 만료되었습니다. 다시 로그인해주세요"),window.location.href="/login",Promise.reject(e)}}403===e.response.status&&n.A.error("접근 권한이 없습니다"),404===e.response.status&&n.A.error("요청하신 정보를 찾을 수 없습니다"),e.response.status>=500&&n.A.error("일시적인 오류가 발생했습니다. 잠시 후 다시 시도해주세요");let l=null===(r=e.response.data)||void 0===r?void 0:r.message;if(l&&![401,403,404].includes(e.response.status)){let e=Array.isArray(l)?l[0]:l;n.A.error(e)}return Promise.reject(e)})},5744:function(e,t,r){"use strict";r.d(t,{fm:function(){return n},fw:function(){return o},hK:function(){return c},mB:function(){return i},y:function(){return s}});var a=r(6305);let s=async e=>(await a.x.get("/api/itinerary",{params:e})).data,n=async e=>(await a.x.get("/api/itinerary/".concat(e))).data,o=async e=>(await a.x.post("/api/itinerary",e)).data,i=async(e,t)=>(await a.x.put("/api/itinerary/".concat(e),t)).data,c=async e=>(await a.x.delete("/api/itinerary/".concat(e))).data},9375:function(e,t,r){"use strict";r.d(t,{t:function(){return n}});var a=r(9625),s=r(6885);let n=(0,a.Ue)()((0,s.tJ)(e=>({user:null,accessToken:null,refreshToken:null,isAuthenticated:!1,setAuth:(t,r,a)=>e({user:t,accessToken:r,refreshToken:a,isAuthenticated:!0}),clearAuth:()=>e({user:null,accessToken:null,refreshToken:null,isAuthenticated:!1}),updateUser:t=>e(e=>({user:e.user?{...e.user,...t}:null}))}),{name:"auth-storage"}))},7802:function(e,t,r){"use strict";r.d(t,{A:function(){return s},E:function(){return a}});let a=(0,r(9625).Ue)(e=>({toasts:[],addToast:t=>{let r="toast-".concat(Date.now(),"-").concat(Math.random()),a={id:r,duration:3e3,...t};e(e=>({toasts:[...e.toasts,a]})),a.duration&&setTimeout(()=>{e(e=>({toasts:e.toasts.filter(e=>e.id!==r)}))},a.duration)},removeToast:t=>e(e=>({toasts:e.toasts.filter(e=>e.id!==t)})),clearToasts:()=>e({toasts:[]})})),s={success:(e,t)=>a.getState().addToast({type:"success",message:e,duration:t}),error:(e,t)=>a.getState().addToast({type:"error",message:e,duration:t}),warning:(e,t)=>a.getState().addToast({type:"warning",message:e,duration:t}),info:(e,t)=>a.getState().addToast({type:"info",message:e,duration:t})}}},function(e){e.O(0,[3464,5883,2971,2117,1744],function(){return e(e.s=8948)}),_N_E=e.O()}]);