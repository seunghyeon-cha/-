(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3680],{1498:function(e,s,t){Promise.resolve().then(t.bind(t,6161))},6161:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return p}});var r=t(7437),a=t(2265),n=t(9376),l=t(9501),o=t(3590),i=t(7119),c=t(8837),d=t(7802),m=t(9375);let u=i.Ry({name:i.Z_().min(2,"장소명은 최소 2자 이상이어야 합니다").max(100),category:i.Km(["TOURIST","RESTAURANT","ACCOMMODATION"],{required_error:"카테고리를 선택해주세요"}),description:i.Z_().min(10,"설명은 최소 10자 이상이어야 합니다"),address:i.Z_().min(5,"주소를 입력해주세요"),lat:i.Rx().min(-90).max(90),lng:i.Rx().min(-180).max(180),contact:i.Z_().optional(),website:i.Z_().url("올바른 URL을 입력해주세요").optional().or(i.i0("")),operatingHours:i.Z_().optional(),images:i.IX(i.Z_()).optional()}),x={TOURIST:"관광지",RESTAURANT:"음식점",ACCOMMODATION:"숙박"};function p(){let e=(0,n.useRouter)(),{user:s}=(0,m.t)(),[t,i]=(0,a.useState)(!1),{register:p,handleSubmit:g,watch:h,setValue:b,formState:{errors:f}}=(0,l.cI)({resolver:(0,o.F)(u),defaultValues:{lat:37.5665,lng:126.978,images:[]}});if(s&&"BUSINESS"!==s.role)return(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"bg-white p-8 rounded-lg shadow-md max-w-md text-center",children:[(0,r.jsx)("svg",{className:"mx-auto h-12 w-12 text-red-500 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"권한이 없습니다"}),(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:"사업자 회원만 장소를 등록할 수 있습니다."}),(0,r.jsx)("button",{onClick:()=>e.back(),className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:"돌아가기"})]})});let y=async s=>{try{i(!0),await (0,c.Nc)(s),d.A.success("장소가 성공적으로 등록되었습니다"),e.push("/places")}catch(e){var t,r;console.error("Failed to create place:",e),d.A.error((null===(r=e.response)||void 0===r?void 0:null===(t=r.data)||void 0===t?void 0:t.message)||"장소 등록에 실패했습니다")}finally{i(!1)}};return(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,r.jsx)("div",{className:"bg-white border-b border-gray-200",children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto px-6 py-6",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"새 장소 등록"}),(0,r.jsx)("p",{className:"mt-1 text-sm text-gray-600",children:"귀하의 사업장 정보를 등록해주세요"})]})}),(0,r.jsx)("div",{className:"max-w-4xl mx-auto px-6 py-8",children:(0,r.jsxs)("form",{onSubmit:g(y),className:"space-y-6",children:[(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 shadow-sm",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"기본 정보"}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["장소명 ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("input",{...p("name"),type:"text",placeholder:"예: 서울타워",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500"}),f.name&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-500",children:f.name.message})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["카테고리 ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsxs)("select",{...p("category"),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",children:[(0,r.jsx)("option",{value:"",children:"선택해주세요"}),Object.entries(x).map(e=>{let[s,t]=e;return(0,r.jsx)("option",{value:s,children:t},s)})]}),f.category&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-500",children:f.category.message})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["설명 ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("textarea",{...p("description"),rows:4,placeholder:"장소에 대한 상세한 설명을 입력해주세요",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500"}),f.description&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-500",children:f.description.message})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 shadow-sm",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"위치 정보"}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["주소 ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("input",{...p("address"),type:"text",placeholder:"예: 서울특별시 중구 남산공원길 105",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500"}),f.address&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-500",children:f.address.message})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["위도 (Latitude) ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("input",{...p("lat",{valueAsNumber:!0}),type:"number",step:"0.000001",placeholder:"37.5665",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500"}),f.lat&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-500",children:f.lat.message})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["경도 (Longitude) ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("input",{...p("lng",{valueAsNumber:!0}),type:"number",step:"0.000001",placeholder:"126.9780",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500"}),f.lng&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-500",children:f.lng.message})]})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 shadow-sm",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"추가 정보"}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"연락처"}),(0,r.jsx)("input",{...p("contact"),type:"text",placeholder:"예: 02-1234-5678",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"웹사이트"}),(0,r.jsx)("input",{...p("website"),type:"url",placeholder:"예: https://example.com",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500"}),f.website&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-500",children:f.website.message})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"운영 시간"}),(0,r.jsx)("input",{...p("operatingHours"),type:"text",placeholder:"예: 평일 09:00-18:00, 주말 10:00-17:00",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500"})]})]}),(0,r.jsxs)("div",{className:"flex gap-3 justify-end",children:[(0,r.jsx)("button",{type:"button",onClick:()=>e.back(),className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"취소"}),(0,r.jsx)("button",{type:"submit",disabled:t,className:"px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:t?"등록 중...":"장소 등록"})]})]})})]})}},6305:function(e,s,t){"use strict";t.d(s,{x:function(){return o}});var r=t(3464),a=t(9375),n=t(7802);let l="http://localhost:4000",o=r.Z.create({baseURL:l,headers:{"Content-Type":"application/json"}});o.interceptors.request.use(e=>{let{accessToken:s}=a.t.getState();return s&&(e.headers.Authorization="Bearer ".concat(s)),e},e=>Promise.reject(e)),o.interceptors.response.use(e=>e,async e=>{var s,t;let i=e.config;if(!e.response)return n.A.error("인터넷 연결을 확인해주세요"),Promise.reject(e);if((null===(s=e.response)||void 0===s?void 0:s.status)===401&&!i._retry){i._retry=!0;try{let{refreshToken:e}=a.t.getState();if(!e)throw Error("No refresh token");let{accessToken:s,refreshToken:t}=(await r.Z.post("".concat(l,"/api/auth/refresh"),{refreshToken:e})).data,{user:n}=a.t.getState();return n&&a.t.getState().setAuth(n,s,t),i.headers.Authorization="Bearer ".concat(s),o(i)}catch(e){return a.t.getState().clearAuth(),n.A.error("세션이 만료되었습니다. 다시 로그인해주세요"),window.location.href="/login",Promise.reject(e)}}403===e.response.status&&n.A.error("접근 권한이 없습니다"),404===e.response.status&&n.A.error("요청하신 정보를 찾을 수 없습니다"),e.response.status>=500&&n.A.error("일시적인 오류가 발생했습니다. 잠시 후 다시 시도해주세요");let c=null===(t=e.response.data)||void 0===t?void 0:t.message;if(c&&![401,403,404].includes(e.response.status)){let e=Array.isArray(c)?c[0]:c;n.A.error(e)}return Promise.reject(e)})},8837:function(e,s,t){"use strict";t.d(s,{Nc:function(){return l},_7:function(){return n},fQ:function(){return a}});var r=t(6305);let a=async e=>(await r.x.get("/api/places",{params:e})).data,n=async e=>(await r.x.get("/api/places/".concat(e))).data,l=async e=>(await r.x.post("/api/places",e)).data},9375:function(e,s,t){"use strict";t.d(s,{t:function(){return n}});var r=t(9625),a=t(6885);let n=(0,r.Ue)()((0,a.tJ)(e=>({user:null,accessToken:null,refreshToken:null,isAuthenticated:!1,setAuth:(s,t,r)=>e({user:s,accessToken:t,refreshToken:r,isAuthenticated:!0}),clearAuth:()=>e({user:null,accessToken:null,refreshToken:null,isAuthenticated:!1}),updateUser:s=>e(e=>({user:e.user?{...e.user,...s}:null}))}),{name:"auth-storage"}))},7802:function(e,s,t){"use strict";t.d(s,{A:function(){return a},E:function(){return r}});let r=(0,t(9625).Ue)(e=>({toasts:[],addToast:s=>{let t="toast-".concat(Date.now(),"-").concat(Math.random()),r={id:t,duration:3e3,...s};e(e=>({toasts:[...e.toasts,r]})),r.duration&&setTimeout(()=>{e(e=>({toasts:e.toasts.filter(e=>e.id!==t)}))},r.duration)},removeToast:s=>e(e=>({toasts:e.toasts.filter(e=>e.id!==s)})),clearToasts:()=>e({toasts:[]})})),a={success:(e,s)=>r.getState().addToast({type:"success",message:e,duration:s}),error:(e,s)=>r.getState().addToast({type:"error",message:e,duration:s}),warning:(e,s)=>r.getState().addToast({type:"warning",message:e,duration:s}),info:(e,s)=>r.getState().addToast({type:"info",message:e,duration:s})}}},function(e){e.O(0,[3464,5883,6245,2971,2117,1744],function(){return e(e.s=1498)}),_N_E=e.O()}]);