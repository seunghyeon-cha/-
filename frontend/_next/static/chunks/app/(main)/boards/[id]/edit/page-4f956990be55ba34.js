(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1134],{5559:function(e,t,r){Promise.resolve().then(r.bind(r,6540))},6540:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return u}});var s=r(7437),a=r(2265),l=r(9376),n=r(9226),i=r(9836),o=r(9375),c=r(7371),d=r(2609),m=r(7802);function u(e){let{params:t}=e,r=(0,l.useRouter)(),{user:u,isAuthenticated:g}=(0,o.t)(),[x,b]=(0,a.useState)(null),[p,h]=(0,a.useState)({category:"FREE",title:"",content:"",images:[],tags:[]}),[f,y]=(0,a.useState)(""),[v,j]=(0,a.useState)(!1),[N,w]=(0,a.useState)(!0);(0,a.useEffect)(()=>{k()},[t.id]);let k=async()=>{try{var e;w(!0);let s=await (0,n.WU)(t.id);if(!u||s.userId!==u.id){m.A.error("수정 권한이 없습니다"),r.push("/boards/".concat(t.id));return}b(s),h({category:s.category,title:s.title,content:s.content,images:s.images||[],tags:(null===(e=s.boardTags)||void 0===e?void 0:e.map(e=>e.tag.name))||[]})}catch(e){console.error("Failed to fetch board:",e),m.A.error("게시글을 불러오는데 실패했습니다"),r.push("/boards")}finally{w(!1)}},C=async e=>{if(e.preventDefault(),!p.title||!p.title.trim()){m.A.warning("제목을 입력해주세요");return}if(p.title.length<2){m.A.warning("제목은 최소 2자 이상이어야 합니다");return}if(!p.content||!p.content.trim()){m.A.warning("내용을 입력해주세요");return}if(p.content.length<10){m.A.warning("내용은 최소 10자 이상이어야 합니다");return}try{j(!0),await (0,n.wN)(t.id,p),m.A.success("게시글이 수정되었습니다"),r.push("/boards/".concat(t.id))}catch(e){var s,a;console.error("Failed to update board:",e),m.A.error((null===(a=e.response)||void 0===a?void 0:null===(s=a.data)||void 0===s?void 0:s.message)||"게시글 수정에 실패했습니다")}finally{j(!1)}},A=()=>{if(f.trim()){if(p.tags&&p.tags.includes(f.trim())){m.A.warning("이미 추가된 태그입니다");return}h({...p,tags:[...p.tags||[],f.trim()]}),y("")}},E=e=>{var t;h({...p,tags:(null===(t=p.tags)||void 0===t?void 0:t.filter(t=>t!==e))||[]})};return N?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"w-16 h-16 border-4 border-primary-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-600",children:"게시글을 불러오는 중..."})]})}):(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 py-12",children:(0,s.jsxs)("div",{className:"max-w-4xl mx-auto px-6",children:[(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"게시글 수정"}),(0,s.jsx)("p",{className:"text-gray-600",children:"게시글을 수정하세요"})]}),(0,s.jsxs)("form",{onSubmit:C,className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-semibold text-gray-900 mb-2",children:["카테고리 ",(0,s.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,s.jsx)("select",{value:p.category,onChange:e=>h({...p,category:e.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",children:Object.entries(i.U).map(e=>{let[t,r]=e;return(0,s.jsx)("option",{value:t,children:r},t)})})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-semibold text-gray-900 mb-2",children:["제목 ",(0,s.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,s.jsx)("input",{type:"text",value:p.title||"",onChange:e=>h({...p,title:e.target.value}),placeholder:"제목을 입력하세요",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-semibold text-gray-900 mb-2",children:["내용 ",(0,s.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,s.jsx)(c.Z,{value:p.content||"",onChange:e=>h({...p,content:e}),placeholder:"게시글 내용을 입력하세요...",minHeight:"400px"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-semibold text-gray-900 mb-2",children:"이미지 (선택)"}),(0,s.jsx)(d.Z,{onUploadComplete:e=>h({...p,images:[...p.images||[],...e]}),maxFiles:10}),p.images&&p.images.length>0&&(0,s.jsx)("div",{className:"mt-4 grid grid-cols-3 gap-4",children:p.images.map((e,t)=>(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("img",{src:e,alt:"Image ".concat(t+1),className:"w-full h-32 object-cover rounded-lg"}),(0,s.jsx)("button",{type:"button",onClick:()=>{var e;return h({...p,images:null===(e=p.images)||void 0===e?void 0:e.filter((e,r)=>r!==t)})},className:"absolute top-2 right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center hover:bg-red-600",children:"\xd7"})]},t))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-semibold text-gray-900 mb-2",children:"태그 (선택)"}),(0,s.jsxs)("div",{className:"flex gap-2 mb-3",children:[(0,s.jsx)("input",{type:"text",value:f,onChange:e=>y(e.target.value),onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),A())},placeholder:"태그를 입력하고 추가 버튼을 클릭하세요",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500"}),(0,s.jsx)("button",{type:"button",onClick:A,className:"px-6 py-2 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors",children:"추가"})]}),p.tags&&p.tags.length>0&&(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:p.tags.map((e,t)=>(0,s.jsxs)("span",{className:"inline-flex items-center gap-2 px-3 py-1.5 bg-primary-100 text-primary-700 rounded-full text-sm",children:["#",e,(0,s.jsx)("button",{type:"button",onClick:()=>E(e),className:"hover:text-primary-900",children:"\xd7"})]},t))})]}),(0,s.jsxs)("div",{className:"flex gap-4 pt-6 border-t border-gray-200",children:[(0,s.jsx)("button",{type:"button",onClick:()=>r.back(),className:"flex-1 px-6 py-3 border border-gray-300 text-gray-700 rounded-lg font-semibold hover:bg-gray-50 transition-colors",children:"취소"}),(0,s.jsx)("button",{type:"submit",disabled:v,className:"flex-1 px-6 py-3 bg-primary-500 text-white rounded-lg font-semibold hover:bg-primary-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:v?"수정 중...":"수정 완료"})]})]})]})})}}},function(e){e.O(0,[3572,7902,3464,5883,3583,6617,2971,2117,1744],function(){return e(e.s=5559)}),_N_E=e.O()}]);